{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chat - Moji</title>

  <link rel="stylesheet" href="{% static 'css/chat.css' %}" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
</head>

<body>
  <div class="chat-layout">
    <a href="{% url 'index' %}" class="exit-button">← Exit</a>

    <!-- 왼쪽 채팅 영역 -->
    <div class="chat-main">
      <div class="chat-header">
      </div>

      <!-- ✅ 진행 바 -->
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>

      <!-- ✅ 채팅 메시지 박스 -->
      <div class="chat-box" id="chat-box">
        <!-- 기본 메시지들 -->
        <div class="message bot">
          <img src="{% static 'images/bot.png' %}" alt="Bot" />
          <div class="message-content">안녕하세요. 무엇을 도와드릴까요?</div>
        </div>
        <div class="message user">
          <img src="{% static 'images/user.png' %}" alt="User" />
          <div class="message-content">기억을 찾고 싶어요!</div>
        </div>
      </div>

      <!-- ✅ 입력 영역 -->
      <div class="chat-input">
        <input type="text" placeholder="메시지를 입력하세요..." />
        <button onclick="nextQuestion()">다음</button>
      </div>
    </div>

    <!-- 오른쪽 기억 목록 카드 영역 -->
    <div class="side-panel">
      <h4>For Your Memory</h4>
      <div class="card-container" id="cardContainer"></div>
      <div class="nav-controls">
        <button onclick="changeCard(-1)">←</button>
        <span id="card-index">01 — 02</span>
        <button onclick="changeCard(1)">→</button>
      </div>
    </div>
  </div>

  <!-- ✅ chat.js 로직 불러오기 -->
  <script src="{% static 'js/chat.js' %}"></script>

  <!-- ✅ 초기 실행 스크립트 -->
  <script>
    function appendUserMessage(text) {
      const chatBox = document.getElementById("chat-box");
      const userDiv = document.createElement("div");
      userDiv.classList.add("message", "user");
      userDiv.innerHTML = `
        <img src="/static/images/user.png" alt="User" />
        <div class="message-content">${text}</div>
      `;
      chatBox.appendChild(userDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // 페이지 로드시 실행
    window.onload = function () {
      appendUserMessage("기억을 찾고 싶어요!");
      showMemoryCategoryQuestion(); // 이 함수는 chat.js에 정의되어 있어야 함
    };
  </script>
</body>
</html>
